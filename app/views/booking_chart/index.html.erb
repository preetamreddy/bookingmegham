<h1>Booking Chart</h1>

<div id="booking_chart">
</div>

<div id="search">
	<%= render 'search' %>
</div>

<% if @booking_chart.count > 0 %>
	<table class="chart">
		<col width="130px" />
		<% @chart_date_range_short.each do |date| %>
			<col width="80px" />
		<% end %>
		<tr>
			<th class="text">Room Type</th>
			<% @chart_date_range_short.each do |date| %>
				<th><%= date %></th>
			<% end %>
	  </tr>

		<% @room_types.each do |room_type| %>	
			<% tr_class = cycle('list_line_odd', 'list_line_even') %>
			<% (1..room_type.number_of_rooms).each do |room_number| %>
	  		<tr class=<%= tr_class %>>
	    		<td class="nowrap"><%= room_type.room_type %></td>
					<% @chart_date_range.each do |date| %>
            <%= show_allocation_with_color_code(@booking_chart[[room_type.id, room_number, date]][2], 
                 title: @booking_chart[[room_type.id, room_number, date]][0],
                 booking_id: @booking_chart[[room_type.id, room_number, date]][3], 
                 room_type_id: room_type.id,
                 date: date) do %>
							<% @booking_chart[[room_type.id, room_number, date]][1] %>
						<% end %>
					<% end %>
				</tr>
			<% end %>
		<% end %>
	</table>
<% else %>
	<div id="error_explanation">
		<h2>Bookings not found</h2>
		<ul>
			<li>Please change your search conditions</li>
		</ul>
	</div>
<% end %>
