<h1>Availability Chart</h1>

<table border="1">
	<tr>
		<th class="text">Property</th>
		<th class="text">Room Type</th>
		<th class="number">Rooms</th>
		<% chart_date = @chart_start_date %>
		<% @days_to_show_in_chart.times do %>
			<th class="number"><%= l chart_date, :format => :short %></th>
			<% chart_date += 1 %>
		<% end %>
		<th></th>
  </tr>
	<% cnt = 0 %>
	<% @room_types.count.times do %>
		<tr class="<%= cycle('list_line_odd', 'list_line_even') %>">
			<td class="text"><%= Property.find(@room_types[cnt].property_id).name %></td>
			<td class="text"><%= @room_types[cnt].room_type %></td>
			<td class="number"><%= @room_types[cnt].number_of_rooms %></td>
			<% column_date = @chart_start_date %>
			<% @days_to_show_in_chart.times do %>
				<% if @line_items[[@room_types[cnt].id, column_date]] %>
					<td class="number"><%= (@room_types[cnt].number_of_rooms - @line_items[[@room_types[cnt].id, column_date]]) %></td>
				<% else %>
					<td class="number"><%= @room_types[cnt].number_of_rooms %></td>
				<% end %>
				<% column_date += 1 %>
			<% end %>
			<td><%= link_to 'New Booking', new_booking_path(:room_type_id => @room_types[cnt].id) %></td>
		</tr>
		<% cnt += 1 %>
	<% end %>
</table>
