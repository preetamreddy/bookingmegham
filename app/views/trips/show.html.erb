<p id="notice"><%= notice %></p>
<h1>Trip Details</h1>

<div class="show_saved_record">
<p>
  <b>Guest:</b>
  <span class="saved_value"><%= @trip.guest.name %>
</p>

<p>
  <b>Trip Name:</b>
  <span class="saved_value"><%= @trip.name %>
</p>

<p>
  <b>Start date:</b>
  <span class="saved_value"><%= l @trip.start_date if @trip.start_date %>
</p>

<p>
  <b>End date:</b>
  <span class="saved_value"><%= l @trip.end_date if @trip.end_date %>
</p>

<% if @trip.rooms.any? %>	
	<b>Rooms:</b>
	<table class="nested_table">
		<tr>
			<th class="text">Single / Double</th>
			<th class="number">Adults / room</th>
			<th class="number">Children / room</th>
			<th class="number">Number of rooms</th>
		</tr>

		<% @trip.rooms.each do |room| %>
			<tr class="<%= cycle('list_line_odd', 'list_line_even') %>">	
				<td class="text"><%= room.occupancy %></td>
				<td class="number"><%= room.number_of_adults %></td>
				<td class="number"><%= room.number_of_children_between_5_and_12_years %></td>
				<td class="number"><%= room.number_of_rooms %></td>
			</tr>
		<% end %>
	</table>
<% end %>

<p>
  <b>Number of children below 5 years:</b>
  <span class="saved_value"><%= @trip.number_of_children_below_5_years %>
</p>

<p>
  <b>Number of drivers:</b>
  <span class="saved_value"><%= @trip.number_of_drivers %>
</p>

<% if @trip.vas_bookings.any? %>
	<b>Value added services:</b>
	<table class="nested_table">
		<tr>
			<th class="text">Name</th>
			<th class="number">#</th>
			<th class="number">Days</th>
			<th class="number">Unit price</th>
			<th class="text">Description</th>
		</tr>

		<% @trip.vas_bookings.each do |vas_booking| %>
			<tr class="<%= cycle('list_line_odd', 'list_line_even') %>">	
				<td class="text"><%= vas_booking.value_added_service.name %></td>
				<td class="number"><%= vas_booking.number_of_people %></td>
				<td class="number"><%= vas_booking.number_of_days %></td>
				<td class="number"><%= vas_booking.unit_price %></td>
				<td class="text"><%= vas_booking.description %></td>
			</tr>
		<% end %>
	</table>
<% end %>

<%= hidden_p_unless(@trip.total_price) do %>
  <b>Total price:</b>
  <span class="saved_value"><%= number_to_currency(@trip.total_price) if @trip.total_price %>
<% end %>

<%= hidden_p_unless(@trip.discount) do %>
  <b>Discount:</b>
  <span class="saved_value"><%= number_to_currency(@trip.discount) if @trip.discount %>
<% end %>

<%= hidden_p_unless(@trip.final_price) do %>
  <b>Final price:</b>
  <span class="saved_value"><%= number_to_currency(@trip.final_price) if @trip.final_price %>
<% end %>

<% if @trip.payments.any? %>
	<b>Payments:</b>
	<table class="nested_table">
		<tr>
			<th class="text">Date</th>
			<th class="number">Amount</th>
			<th class="text">Details</th>
		</tr>

		<% @trip.payments.each do |payment| %>
			<tr class="<%= cycle('list_line_odd', 'list_line_even') %>">	
				<td class="text">
					<%= l payment.date_recieved if payment.date_recieved %>
				</td>
				<td class="number"><%= number_to_currency(payment.amount) %></td>
				<td class="text"><%= payment.details %></td>
			</tr>
		<% end %>
	</table>
<% end %>

<%= hidden_p_unless(@trip.balance_payment) do %>
  <b>Balance:</b>
  <span class="saved_value"><%= number_to_currency(@trip.balance_payment) if @trip.balance_payment %>
<% end %>

<%= hidden_p_unless(@trip.pay_by_date) do %>
  <b>Pay by:</b>
  <span class="saved_value"><%= l @trip.pay_by_date if @trip.pay_by_date %>
<% end %>

<%= hidden_p_unless(@trip.food_preferences != "") do %>
  <b>Food preferences:</b>
  <span class="saved_value"><%= @trip.food_preferences %>
<% end %>

<p>
  <b>Comments:</b>
  <span class="saved_value"><%= @trip.comments %>
</p>
</div>

<div class="action_container">
	<%= link_to 'Edit', edit_trip_path(@trip) %> |
	<%= link_to 'Check Availability', 
				availability_chart_path(:trip_id => @trip.id) %>
</div>

<%= link_to 'Back to Trip Listing', trips_path, :class => "back_link" %>
