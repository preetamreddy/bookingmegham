<h1>Trip Details</h1>

<div class="show_saved_record">
<p>
  <b>ID:</b>
  <span class="saved_value"><%= @trip.id %>
</p>

<p>
  <b>Guest:</b>
  <span class="saved_value"><%= @trip.guest.name %>
</p>

<p>
  <b>Agency:</b>
	<% if @trip.agency_id %>
  	<span class="saved_value"><%= @trip.agency.name %>
	<% end %>
</p>

<p>
  <b>Direct booking:</b>
	<% if @trip.direct_booking == 1 %>
  	<span class="saved_value"><%= @trip.direct_booking.to_english %>
	<% end %>
</p>

<p>
  <b>Trip Name:</b>
  <span class="saved_value"><%= @trip.name %>
</p>

<p>
  <b>Start date:</b>
  <span class="saved_value"><%= l @trip.start_date %>
</p>

<p>
  <b>End date:</b>
  <span class="saved_value"><%= l @trip.end_date %>
</p>

<p>
  <b>Days:</b>
  <span class="saved_value"><%= @trip.number_of_days %>
</p>

<% if @trip.rooms.any? %>	
	<b>Rooms:</b>
	<table class="nested_table">
		<tr>
			<th class="text">Single / Double</th>
			<th class="number">Number of rooms</th>
			<th class="number">Adults / room</th>
			<th class="number">Children / room</th>
			<th class="number">Infants / room</th>
		</tr>

		<% @trip.rooms.each do |room| %>
			<tr class="<%= cycle('list_line_odd', 'list_line_even') %>">	
				<td class="text"><%= room.occupancy %></td>
				<td class="number"><%= room.number_of_rooms %></td>
				<td class="number"><%= room.number_of_adults %></td>
				<td class="number"><%= room.number_of_children_between_5_and_12_years %></td>
				<td class="number"><%= room.number_of_children_below_5_years %></td>
			</tr>
		<% end %>
	</table>
<% end %>

<p>
  <b>Drivers:</b>
  <span class="saved_value"><%= @trip.number_of_drivers %>
</p>

<% if @trip.vas_bookings.any? %>
	<b>Value Added Services:</b>
	<table class="nested_table">
		<tr>
			<th class="text">Name</th>
			<th class="number">Unit price</th>
			<th class="number">#</th>
			<th class="number">Total price</th>
		</tr>

		<% @trip.vas_bookings.each do |vas_booking| %>
			<tr class="<%= cycle('list_line_odd', 'list_line_even') %>">
				<td class="text"><%= vas_booking.value_added_service %></td>
				<td class="number"><%= number_to_currency(vas_booking.unit_price) %></td>
				<td class="number"><%= vas_booking.number_of_units %></td>
				<td class="number"><%= number_to_currency(vas_booking.total_price) %></td>
			</tr>
		<% end %>
	</table>
<% end %>

<%= hidden_p_unless(@trip.total_price > 0) do %>
  <b>Payment Status:</b>
  <span class="saved_value"><%= @trip.payment_status if @trip.payment_status %>
<% end %>

<%= hidden_p_unless(@trip.total_price > 0) do %>
  <b>Total price:</b>
  <span class="saved_value"><%= number_to_currency(@trip.total_price) if @trip.total_price %>
<% end %>

<%= hidden_p_unless(@trip.total_price > 0) do %>
  <b>Discount:</b>
  <span class="saved_value"><%= number_to_currency(@trip.discount) if @trip.discount %>
<% end %>

<%= hidden_p_unless(@trip.total_price > 0 && @trip.direct_booking == 0) do %>
  <b>TAC:</b>
  <span class="saved_value"><%= number_to_currency(@trip.tac) if @trip.tac %>
<% end %>

<%= hidden_p_unless(@trip.total_price > 0 && @trip.direct_booking == 0) do %>
  <b>TDS on commission:</b>
  <span class="saved_value"><%= number_to_currency(@trip.tds) if @trip.tac %>
<% end %>

<%= hidden_p_unless(@trip.total_price > 0) do %>
  <b>Final price:</b>
  <span class="saved_value"><%= number_to_currency(@trip.final_price) if @trip.final_price %>
<% end %>

<%= hidden_p_unless(@trip.total_price > 0) do %>
  <b>Paid:</b>
  <span class="saved_value"><%= number_to_currency(@trip.paid) if @trip.paid %>
<% end %>

<%= hidden_p_unless(@trip.total_price > 0) do %>
  <b>Refund amount:</b>
  <span class="saved_value"><%= number_to_currency(@trip.refund_amount) if @trip.refund_amount %>
<% end %>

<%= hidden_p_unless(@trip.total_price > 0) do %>
  <b>Balance:</b>
  <span class="saved_value"><%= number_to_currency(@trip.balance_payment) if @trip.balance_payment %>
<% end %>

<%= hidden_p_unless(@trip.total_price > 0) do %>
  <b>Pay by:</b>
  <span class="saved_value"><%= l @trip.pay_by_date if @trip.pay_by_date %>
<% end %>

<p>
  <b>Invoice date:</b>
  <span class="saved_value"><%= l @trip.invoice_date if @trip.invoice_date %>
</p>

<%= hidden_p_unless(@trip.total_price > 0) do %>
  <b>Service tax:</b>
  <span class="saved_value"><%= number_to_currency(@trip.service_tax) if @trip.service_tax %>
<% end %>

<p>
  <b>Food preferences:</b>
  <span class="saved_value"><%= @trip.food_preferences %>
</p>

<p>
  <b>Medical constraints:</b>
  <span class="saved_value"><%= @trip.medical_constraints %>
</p>

<p>
  <b>Dist. email id(s):</b>
  <span class="saved_value"><%= @trip.email_ids %>
</p>

<p>
  <b>Remarks:</b>
  <span class="saved_value"><%= @trip.remarks %>
</p>

<p>
  <b>Advisor:</b>
  <span class="saved_value"><%= @trip.advisor.name %>
</p>
</div>

<div class="action_container">
	<%= link_to 'Edit', edit_trip_path(@trip) %>
	<%= link_to 'View Bookings', bookings_path(:trip_id => @trip.id) %>
	<%= link_to 'Email Itinerary', email_trip_path(:trip_id => @trip.id,
				:type => 'itinerary') %>
	<%= link_to 'Generate Invoice', email_trip_path(:trip_id => @trip.id,
				:type => 'invoice') %>
	<%= link_to 'Generate Vouchers', email_trip_path(:trip_id => @trip.id,
				:type => 'vouchers') %>
</div>

<%= link_to 'Back to Trip Listing', trips_path, :class => "back_link" %>
